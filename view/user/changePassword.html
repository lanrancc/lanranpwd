{extend name="layout"/}
{block name="main"}
<div class="col-xs-12 col-sm-10 col-md-8 col-lg-12 center-block" style="float: none;">
  <div class="panel panel-danger">
    <div class="panel-heading">修改密码</div>
    <div class="panel-body">
      <form id="changePassword">
        <div class="form-group">
          <label for="oldpass">旧密码</label>
          <input type="text" name="oldpass" class="form-control" id="oldpass">
        </div>
        <div class="form-group">
          <label for="password">新密码</label>
          <input type="text" name="password" class="form-control" id="password">
        </div>
        <div class="form-group">
          <label for="cpass">确认密码</label>
          <input type="text" name="cpass" class="form-control" id="cpass">
        </div>
        <button type="button" class="btn btn-success" @click="changePassword()">修改</button>
      </form>
    </div>
  </div>
</div>
{/block}
{block name="foot"}
<script>
  new Vue({
    el: '#app',
    methods: {
      changePassword: function () {
        let self = this;
        lxy.ajax('/user/ajax/changePassword', $("#changePassword").serialize(), res => {
          if (res.code === 200) {
            layer.msg(res.msg);
            setTimeout(function () {
              window.location.href = "/user/login";
            }, 1000);
          } else {
            layer.msg(res.msg);
          }
        });
      }
    }
  })
</script>
{/block}